\def\intervalplot#1#2{%
  \addplot[%
    name path=lower,%
    draw=none,%
    fill=none,%
  ] table [%
    col sep=comma,%
    x=length,%
    y expr=\thisrow{max_likelihoods_#1} - \thisrow{variance_#1}%
  ] {\tracelengthcsv};%
  \addplot[%
    name path=upper,%
    draw=none,%
    fill=none,%
  ] table [%
    col sep=comma,%
    x=length,%
    y expr=\thisrow{max_likelihoods_#1} + \thisrow{variance_#1}%
  ] {\tracelengthcsv};%
  \addplot [%
    color=#2,%
    opacity=0.6,%
  ] fill between[of=lower and upper];%
  \addplot[%
    color=#2,%
  ] table [%
    col sep=comma,%
    x=length,%
    y=max_likelihoods_#1,%
  ] {\tracelengthcsv};%
}%
\begin{tikzpicture}
  \begin{axis}[
    width=\textwidth,
    height=\textwidth,
    xlabel={length [frames]},
    ylabel=estimated count,
    enlarge x limits=false,
    enlarge y limits=false,
    xtick distance=4000,
    ytick distance=5,
    ymin=0,
    grid=major,
    grid style={dashed},
    scaled ticks=false,
    ticklabel style={font=\small},
    legend style={nodes={scale=0.6, transform shape}},
  ]
  \intervalplot{20}{funkey_color_1}
  \addlegendentry{$\n = 20$}%
  \intervalplot{15}{funkey_color_2}
  \addlegendentry{$\n = 15$}%
  \intervalplot{10}{funkey_color_3}
  \addlegendentry{$\n = 10$}%
  \intervalplot{5}{funkey_color_4}
  \addlegendentry{$\n = 5$}%
  \end{axis}
\end{tikzpicture}%
