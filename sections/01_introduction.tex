\section{Introduction}

% FLIP this first paragraph
Often in fluorescence microscopy, localization is only the first step, and precise quantitative information, 
  such as molecular count, is required to gain a deeper understanding of the system.
  %
  For large structures, such as whole cells or organelles, individual \objects can be spatially separated, 
  and counting becomes trivial.
  %
  However, due to the diffraction limit, standard fluorescent imaging methods cannot distinguish individual \objects 
  below roughly 200 nm in size. 
  %
  In this regime, individual \objects can no longer be spatially separated, and counting becomes much more challenging. 
  %
  The development of super-resolution techniques \cite{betzig_2006, rust_2006}, has surpassed the diffraction limit, and allows
  for the spatial separation of \objects as close as 10 nm apart \cite{valli_seeing_2021}.
  %
  However, many \objects of interest are smaller still, or physically spaced closer 
  together and cannot be spatially separated even with super-resolution techniques.

% % Fluorescence microscopy is a foundational tool
% Fluorescence microscopy is a foundational tool in the field of biology,
%   providing essential information on the presence and localization 
%   of labeled structures.
%   % Standard fluorescence is limited by the diffraction limit
%   Due to the diffraction limit, standard fluorescence imaging methods are unable to distinguish 
%   individual structures below 200 nm in size.
%   % Super resolution has added a ton
%   The development of super resolution imaging techniques \cite{betzig_2006, rust_2006} has surpassed 
%   this limit and achieved resolutions as high as 10 nm \cite{valli_seeing_2021}.
% % However getting quantitative information, specifically absolute counts out of these methods is difficult
%   These advances have been revolutionary to understanding biology, 
%   but often localization is only the first step,
%   and a deeper understanding of the system requires more precise
%   quantitative information, such as molecular count. 

% absolute counts can tell us alot about biology
% re-format this as a list, and be much more direct about how counting would help here
Molecular counting aims to determine the absolute number of molecules
  associated in a \object, a quantity that is often essential to understanding the
  underlying biology of a system. 
  %
  Here are three examples:
  \begin{itemize}

    \item Immune response: the activation of T cells is sensitive to single ligands, and quantifying 
      the molecular count of ligand - receptor interactions informs understanding of downstream signalling pathways and sensitivity~\cite{irvine_2002}.

    \item TGF-$\beta$ signaling: the function of Smad is dependant on its oligomeric state. Determining the relative 
      amounts of monomeric, and trimeric states, though molecular counting, informs understanding of pathway activity.

    \item GPCRs signaling: G-protein coupled receptors exist as monomers, dimers, or higher order oligomers, 
      and again downstream signalling is dependant on oligomeric state~\cite{felce_2018, breitwieser_2004}.
      Quantifying molecular count of these oligomers would inform understanding of the signalling state of the cell.

  \end{itemize}

  % %
  % % Number of ligands to activate a T cell
  % In the immune response, for example, different single-molecule counts of
  % ligands can stimulate different responses in the activation of
  % T-cells~\cite{irvine_2002}.
  % % oligomerization of Smad in TGF-B signalling
  % In the TGF-B singalling pathway, the molecular specificity of Smad signalling
  % proteins depends on their oligomeric state, with monomers, homotrimers, and
  % heterotrimers, where only heterotrimers translocate to the
  % nucleus~\cite{moustakas_2002, inman_2002}.
  % % G protein coupled receptor clustering
  % G-protein coupled receptors exist as monomers, dimers, or higher order
  % oligomers, and their oligomerization state has significant effects on ligand
  % binding, receptor activation, receptor signalling, and
  % trafficing~\cite{felce_2018, breitwieser_2004}.
  % % When objects are large, clustering is easy
  % % when objects become small it gets harder
  % % An algorithm that could reliably count these small objects would be great
  % Although other characterization techniques exist \todo{add refs}, a robust,
  % accurate, fluorescence based molecular counting method would greatly simplify
  % the process\todo{which process?} and also allow multiplexing with the other
  % benefits of fluorescent imaging, such as localization.

% Related work
% fluorescence intensity based counting
Perhaps the simplest method of molecular counting is correlating fluorescent
  intensity with the number of labels \cite{schmied_2012, tolar_2005}, \ie the brighter the spot is, the more there are.
  %
  This method works well for qualitative measures, but due to the noise in intensities 
  measured from any single fluorophore, lacks the precision needed to report exact counts.
  % Other methods work by separating things out in time
  In order to extract more information from the system, other methods utilize temporal information, 
  in addition to intensity based information. 
  % FCS and bSOFI
  Methods such as fluorescence correlation spectroscopy (FCS) \cite{otsuka_2023, wachsmuth_2015, politi_2018} and 
  balanced super-resolution optical fluctuation imaging (bSOFI) \cite{geissbuehler_2012}
  utilize random fluctuations (fit higher order statistics?) in fluorescent intensity over time to estimate the molecular count.
  % Bleaching based
  In other methods, temporal variation in intensity can be induced, rather than just random, \ie
  counting, by measuring the number of distinct bleaching steps observed \cite{ulbrich_2007, jain_2011}.
  % PALM and STORM based
  Methods have also been developed based on the blinking fluorphores used in PALM and STORM. 
  % Some of these methods are also based on HMMs, should we mention that here?
  The known blinking behaviour allows for more precise models than the random fluctuations measured in FCS and bSOFI, while the 
  repeated transitions in intensity provide more information than the irreversible switch in bleaching based counting.
  % PALM based
  \cite{sengupta_pcPALM_2011, lee_counting_2012}
  % SOTRM Based
  \cite{patel_blinking_2021}
  % general
  \cite{rollins_stochastic_2015, nino_2017}
  % dSTORM
  % Limitations
  A major limitation of these methods is the effect of photobleaching, this limits the amount of time
  a single fluorophore can be observed, and makes it difficult to diffrerentiate blinking from photobleaching.


% DNA-PAINT is extra useful because its emitters dont bleach either
In contrast, DNA-PAINT \cite{schnitzbauer_2017} is a method of producing blinking fluorescence that is functionally
    immune to photobleaching due to the continuous replenishment of fluorophores from solution.
    % lbFCS
    Localization based FCS (lbFCS) \cite{stein_2021}, combines the structured blinking of DNA-PAINT, with the 
    principles of FCS, fitting the autocorrelation function of intensity over time to produce a count,
    and is able to count up to 6 molecules in a single diffraction limited spot.
    % qPAINT
    Quantitative DNA-PAINT (qPAINT \cite{jungmann_2016}) estiamtes the molecular count based on the frequency of blinking events, \ie, 
    a blinking rate of 1 event per second is calibrated to 1 molecule, therefore an obervation of 10 events per second
    produces a count of 10 molecules.
    % Limitations
    Both of these methods are limited in that they fit summary statistics,
    rather than the data directly. 
    %
    Further, all of the methods mentioned provide a single estimate of molecular count.
    A well calibrated probabilistic estimate would provide 
    
% Our Model
% ----------
% fully Bayesian
We propose \ours, a fully Bayesian model to estimate the molecular 
  count directly from a fluctuating sequence of fluorescent intensity measurements over time.
  % Based on a fully differentiable markov chain
  Based on a fully differentiable Hidden Markov Model, \ours fits 7 parameters
  directly to the sequence of measurements, estimating a likelihood for each possible count. 
  % probabilistic
  These likelihoods can be directly compared, producing a posterior distribution of counts 
  given the observation sequence. 
  % more accurate than existing methods 

Here we first validate \ours on simualted experiments.

%TODO: add exact size information
% TODO: add references
